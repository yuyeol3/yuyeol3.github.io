
      <html lang="ko">
      <head>
        <title>1504 - íŠ¹ì •í•œ ìµœë‹¨ ê²½ë¡œ</title>
        <link rel="canonical" href="http://yuyeol3.github.io/"/>
        <meta charset="utf-8"/>
        <meta name="description" content="ì´ ë¬¸ì œëŠ” 1ë¶€í„° Nê¹Œì§€ ì´ë™í•  ë•Œ u, vë¥¼ ë°˜ë“œì‹œ ê±°ì¹˜ëŠ” ìµœë‹¨ê²½ë¡œì˜ ê±°ë¦¬ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œë¡œ ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ ì‚¬ìš©í•˜ë©´ í’€ ìˆ˜ ìˆë‹¤.">
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
      </head>
      <body style="display : none;">
        
        <h1>1504 - íŠ¹ì •í•œ ìµœë‹¨ ê²½ë¡œ</h1>
<p>ì´ ë¬¸ì œëŠ” 1ë¶€í„° Nê¹Œì§€ ì´ë™í•  ë•Œ u, vë¥¼ ë°˜ë“œì‹œ ê±°ì¹˜ëŠ” ìµœë‹¨ê²½ë¡œì˜ ê±°ë¦¬ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œë¡œ ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ ì‚¬ìš©í•˜ë©´ í’€ ìˆ˜ ìˆë‹¤.</p>
<p>ì´ ë¬¸ì œì—ì„œ ëˆˆì—¬ê²¨ë´ì•¼ í•  ê³³ì´ ìˆëŠ”ë°, ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<blockquote>
<p>ì„¸ì¤€ì´ëŠ” í•œë²ˆ ì´ë™í–ˆë˜ ì •ì ì€ ë¬¼ë¡ , í•œë²ˆ ì´ë™í–ˆë˜ ê°„ì„ ë„ ë‹¤ì‹œ ì´ë™í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë°˜ë“œì‹œ ìµœë‹¨ ê²½ë¡œë¡œ ì´ë™í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì— ì£¼ì˜í•˜ë¼. </p>
</blockquote>
<p>ì¦‰ ìš°ë¦¬ê°€ ê²½ë¡œë¥¼ ì°¾ì„ ë•Œ ê°„ì„ ì´ë‚˜ ì •ì ì´ ì¤‘ë³µë˜ëŠ”ì§€ëŠ” ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ë‹¤. ë‹¨ì§€ ê·¸ ê²½ë¡œì˜ ê±°ë¦¬ê°€ ìµœì†Œì¸ì§€ë§Œ í™•ì¸í•˜ë©´ ëœë‹¤. </p>
<p>ì´ì œ $dist(a, b)$ê°€ ì •ì  aì—ì„œ bê¹Œì§€ ìµœë‹¨ê±°ë¦¬ë¥¼ ì£¼ëŠ” í•¨ìˆ˜ë¼ê³  í•  ë•Œ $dist(1, N)$ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>
<p>$$</p>
<p>dist(1, N) = \min \begin{cases} dist(1, u) + dist(u, v) + dist(v, N) \ dist(1, v) + dist(v, u) + dist(u, N) \end{cases}</p>
<p>$$</p>
<p>ì™œ ê° ì •ì ì—ì„œ ì •ì ê¹Œì§€ì˜ ìµœì†Œ ê±°ë¦¬ë¥¼ ë”í•œ ê²ƒì´ ì „ì²´ì˜ ìµœì†Œ ê±°ë¦¬ê°€ ë ê¹Œ? ê·€ë¥˜ë²•ìœ¼ë¡œ í™•ì¸í•´ë³´ì. ì–´ë–¤ ì •ì ìœ¼ë¡œë¶€í„° ì •ì ê¹Œì§€ì˜ ìµœì†Œ ì´ë™ ê²½ë¡œì—ì„œ ì–´ë–¤ ë¶€ë¶„ ê²½ë¡œê°€ ìµœì†Œê°€ ì•„ë‹ ìˆ˜ ìˆë‹¤ê³  í•˜ì. ê·¸ë ‡ë‹¤ë©´ ê·¸ ë¶€ë¶„ê²½ë¡œê°€ ìµœì†Œê°€ ì•„ë‹ˆë¯€ë¡œ ìµœì†Œ ê²½ë¡œë¡œ ê°ˆì•„ë¼ìš°ë©´ ê¸°ì¡´ ìµœì†Œ ê²½ë¡œë³´ë‹¤ ë” ì‘ì€ ì „ì²´ ìµœì†Œ ê²½ë¡œê°€ ìƒê¸°ëŠ”ë°, ì´ëŠ” ëª¨ìˆœì´ë‹¤. ë”°ë¼ì„œ ì „ì²´ ê²½ë¡œê°€ ìµœì†Œ ë¹„ìš©ì´ë©´ ë¶€ë¶„ ê²½ë¡œë„ ìµœì†Œ ë¹„ìš©ì´ë‹¤.</p>
<p><a href="https://www.acmicpc.net/problem/1504">ğŸ”— ë¬¸ì œ ë§í¬</a></p>
<h2>ì½”ë“œ</h2>
<p>ê°„ì„ ì´ë‚˜ íƒìƒ‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ìœ í‹¸ í´ë˜ìŠ¤ë¡œ <code>Pair</code>ì„ ì„ ì–¸í•œë‹¤.</p>
<pre><code class="language-java">static class Pair&lt;T1, T2&gt; {
    public T1 x;
    public T2 y;

    public Pair(T1 x, T2 y) {
        this.x = x;
        this.y = y;
    }
}
</code></pre>
<p>ì •ì ì˜ ê°œìˆ˜ <code>N</code>ê³¼ ê°„ì„ ì˜ ê°œìˆ˜ <code>E</code>ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ë‹¤ìŒìœ¼ë¡œ ê·¸ë˜í”„ë¥¼ í‘œí˜„í•  ë³€ìˆ˜ <code>graph</code>ë¥¼ ì„ ì–¸í•˜ê³  ArrayListë¡œ ì´ˆê¸°í™”í•œë‹¤.</p>
<pre><code class="language-java">public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    int N, E;
    N = Integer.parseInt(st.nextToken());
    E = Integer.parseInt(st.nextToken());

    @SuppressWarnings(&quot;unchecked&quot;)
    List&lt;Pair&lt;Integer, Integer&gt;&gt;[] graph = new List[N+1];

    for (int i = 0; i &lt;= N; i++) 
        graph[i] = new ArrayList&lt;&gt;();
</code></pre>
<p>ê·¸ë˜í”„ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ë¬¸ì œì—ì„œ ëŒ€ì¹­ì´ë¼ê³  í•˜ì˜€ìœ¼ë¯€ë¡œ from, to ì–‘ìª½ì— ëª¨ë‘ ê°„ì„ ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ ë°˜ë“œì‹œ ê±°ì³ì•¼ í•˜ëŠ” ì •ì  <code>u</code>, <code>v</code>ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤.</p>
<pre><code class="language-java">    for (int i = 0; i &lt; E; i++) {
        st = new StringTokenizer(br.readLine());
        int from, to, weight;

        from = Integer.parseInt(st.nextToken());
        to = Integer.parseInt(st.nextToken());
        weight = Integer.parseInt(st.nextToken());

        graph[from].add(new Pair&lt;Integer, Integer&gt;(to, weight));
        graph[to].add(new Pair&lt;Integer, Integer&gt;(from, weight));
    }

    st = new StringTokenizer(br.readLine());
    int u, v;
    u = Integer.parseInt(st.nextToken());
    v = Integer.parseInt(st.nextToken());
</code></pre>
<p>ì´ì œ í•„ìš”í•œ ë‹¤ìµìŠ¤íŠ¸ë¼ ì—°ì‚°ì„ í•œë‹¤. <code>dist1</code>ì—ëŠ” ì •ì  1ì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤. <code>distUV</code>ì—ëŠ” ì •ì  uì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤.  <code>distN</code>ì—ëŠ” ì •ì  Nì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤.</p>
<p>ì´ ì„¸ ê°€ì§€ë¥¼ ëª¨ë‘ êµ¬í–ˆë‹¤ë©´ ë‹µì„ ê³„ì‚°í•œë‹¤. ì´ ë¬¸ì œì—ì„œ ê·¸ë˜í”„ëŠ” ë¬´í–¥ì´ë¯€ë¡œ $dist(u, v) = dist(v, u)$, $dist(v, N) = dist(N, v)$, $dist(u, N) = dist(N, u)$ ë¥¼ ì´ìš©í•´ ì•„ë˜ ì½”ë“œì™€ ê°™ì´ ì‹ì„ ì„¸ìš¸ ìˆ˜ ìˆë‹¤.</p>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ë‹µì„ ì¶œë ¥í•œë‹¤. ë§Œì•½ <code>result</code>ê°€ <code>INF</code>ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ë‹¤ë©´ 1, Nê¹Œì§€ ê°ˆ ìˆ˜ ìˆëŠ” ê²½ë¡œê°€ ì—†ë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ -1ì„ ì¶œë ¥í•˜ê³  ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ <code>result</code>ë¥¼ ì¶œë ¥í•œë‹¤.</p>
<pre><code class="language-java">    long dist1[] = new long[N+1];
    dijkstra(1, dist1, graph);

    long distUV[] = new long[N+1];
    dijkstra(u, distUV, graph);

    long distN[] = new long[N+1];
    dijkstra(N, distN, graph);

    long result = Math.min(
        dist1[u] + distUV[v] + distN[v],
        dist1[v] + distUV[v] + distN[u]
    );

    System.out.println((result &gt;= INF ? -1 : result));
}
</code></pre>
<p>ë‹¤ìµìŠ¤íŠ¸ë¼ í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤. ì¼ë°˜ì ì¸ êµ¬í˜„ ë°©ë²•ëŒ€ë¡œ êµ¬í˜„í–ˆìœ¼ë©° distë¥¼ ì™¸ë¶€ì—ì„œ ì°¸ì¡°í˜•ì‹ìœ¼ë¡œ ë°›ì•„ ê²°ê³¼ë¥¼ ë„£ì–´ì¤€ë‹¤.</p>
<pre><code class="language-java">public static void dijkstra(int st, long[] dist, final List&lt;Pair&lt;Integer, Integer&gt;&gt;[] graph) {
    Arrays.fill(dist, INF);
    PriorityQueue&lt;Pair&lt;Integer, Long&gt;&gt; pq = new PriorityQueue&lt;&gt;(Comparator.comparingLong(e-&gt;e.y));

    pq.offer(new Pair&lt;Integer, Long&gt;(st, 0L));
    dist[st] = 0;

    while (!pq.isEmpty()) {
        Pair&lt;Integer, Long&gt; s = pq.poll();

        if (s.y &gt; dist[s.x]) continue;

        for (Pair&lt;Integer, Integer&gt; adj : graph[s.x]) {
            if (s.y + adj.y &lt; dist[adj.x]) {
                dist[adj.x] = s.y + adj.y;
                pq.offer(new Pair&lt;Integer, Long&gt;(adj.x, dist[adj.x]));
            }
        }
    }

}
</code></pre>
<h2>ì „ì²´ ì½”ë“œ</h2>
<pre><code class="language-java">import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    static class Pair&lt;T1, T2&gt; {
        public T1 x;
        public T2 y;

        public Pair(T1 x, T2 y) {
            this.x = x;
            this.y = y;
        }
    }

    static final long INF = Long.MAX_VALUE / 4;
    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        int N, E;
        N = Integer.parseInt(st.nextToken());
        E = Integer.parseInt(st.nextToken());

        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;Pair&lt;Integer, Integer&gt;&gt;[] graph = new List[N+1];

        for (int i = 0; i &lt;= N; i++) 
            graph[i] = new ArrayList&lt;&gt;();

        for (int i = 0; i &lt; E; i++) {
            st = new StringTokenizer(br.readLine());
            int from, to, weight;

            from = Integer.parseInt(st.nextToken());
            to = Integer.parseInt(st.nextToken());
            weight = Integer.parseInt(st.nextToken());

            graph[from].add(new Pair&lt;Integer, Integer&gt;(to, weight));
            graph[to].add(new Pair&lt;Integer, Integer&gt;(from, weight));
        }

        st = new StringTokenizer(br.readLine());
        int u, v;
        u = Integer.parseInt(st.nextToken());
        v = Integer.parseInt(st.nextToken());

        long dist1[] = new long[N+1];
        dijkstra(1, dist1, graph);

        long distUV[] = new long[N+1];
        dijkstra(u, distUV, graph);

        long distN[] = new long[N+1];
        dijkstra(N, distN, graph);

        long result = Math.min(
            dist1[u] + distUV[v] + distN[v],
            dist1[v] + distUV[v] + distN[u]
        );

        System.out.println((result &gt;= INF ? -1 : result));
    }

    public static void dijkstra(int st, long[] dist, final List&lt;Pair&lt;Integer, Integer&gt;&gt;[] graph) {
        Arrays.fill(dist, INF);
        PriorityQueue&lt;Pair&lt;Integer, Long&gt;&gt; pq = new PriorityQueue&lt;&gt;(Comparator.comparingLong(e-&gt;e.y));

        pq.offer(new Pair&lt;Integer, Long&gt;(st, 0L));
        dist[st] = 0;

        while (!pq.isEmpty()) {
            Pair&lt;Integer, Long&gt; s = pq.poll();

            if (s.y &gt; dist[s.x]) continue;

            for (Pair&lt;Integer, Integer&gt; adj : graph[s.x]) {
                if (s.y + adj.y &lt; dist[adj.x]) {
                    dist[adj.x] = s.y + adj.y;
                    pq.offer(new Pair&lt;Integer, Long&gt;(adj.x, dist[adj.x]));
                }
            }
        }

    }
} 
</code></pre>
<h2>ì‹œê°„ë³µì¡ë„</h2>
<p>ë‹¤ìµìŠ¤íŠ¸ë¼ì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O((V+E)\log V)$ ë¡œ ì•Œë ¤ì ¸ ìˆìœ¼ë©° ì´ ë¬¸ì œì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O(3 (N + E) \log N) \approx O((N+E) \log N)$ ì´ë‹¤. ìµœì•…ì˜ ê²½ìš°ì—ë„ $200800 \times \log 800 \approx 2008000$ ì´ë¯€ë¡œ ì»´í“¨í„°ê°€ 1ì´ˆì— ì—°ì‚°í•  ìˆ˜ ìˆëŠ” ì—°ì‚°íšŸìˆ˜ 1ì–µë³´ë‹¤ í›¨ì”¬ ì‘ë‹¤. ë”°ë¼ì„œ ì‹œê°„ì´ˆê³¼ ì—†ì´ í†µê³¼ ê°€ëŠ¥í•˜ë‹¤.</p>

        <script>
          location.href = "/post-view?href=posts%2FPS%2F2026-01-15-%EB%B0%B1%EC%A4%80-1504-%ED%8A%B9%EC%A0%95%ED%95%9C-%EC%B5%9C%EB%8B%A8-%EA%B2%BD%EB%A1%9C.md"
        </script>
      </body>
  