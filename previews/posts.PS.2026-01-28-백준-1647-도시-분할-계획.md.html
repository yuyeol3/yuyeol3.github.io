
      <html lang="ko">
      <head>
        <title>1647 - ë„ì‹œ ë¶„í•  ê³„íš</title>
        <link rel="canonical" href="http://yuyeol3.github.io/"/>
        <meta charset="utf-8"/>
        <meta name="description" content="ì´ ë¬¸ì œì—ì„œëŠ” ì–´ë–¤ ê·¸ë˜í”„ê°€ ì£¼ì–´ì§ˆ ë•Œ, ê·¸ ê·¸ë˜í”„ì—ì„œ ì •ì ì„ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ë©´ì„œ ê·¸ë£¹ ë‚´ ì •ì ë¼ë¦¬ ì´ë™í•  ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ìœ ì§€í•˜ëŠ” ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ì˜ í•©ì˜ ìµœì†Œê°€ ì–¼ë§ˆì¸ì§€ ì°¾ì•„ì•¼ í•œë‹¤.">
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
      </head>
      <body style="display : none;">
        
        <h1>1647 - ë„ì‹œ ë¶„í•  ê³„íš</h1>
<p>ì´ ë¬¸ì œì—ì„œëŠ” ì–´ë–¤ ê·¸ë˜í”„ê°€ ì£¼ì–´ì§ˆ ë•Œ, ê·¸ ê·¸ë˜í”„ì—ì„œ ì •ì ì„ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ë©´ì„œ ê·¸ë£¹ ë‚´ ì •ì ë¼ë¦¬ ì´ë™í•  ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ìœ ì§€í•˜ëŠ” ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ì˜ í•©ì˜ ìµœì†Œê°€ ì–¼ë§ˆì¸ì§€ ì°¾ì•„ì•¼ í•œë‹¤.</p>
<p>ë§Œì•½ ë¬¸ì œê°€ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ì •ì ë¼ë¦¬ ì´ë™í•  ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ìœ ì§€í•˜ëŠ” ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ì˜ í•©ì˜ ìµœì†Œë¥¼ ë¬¼ì—ˆë‹¤ë©´ MSTë¡œ í•´ê²°í•  ìˆ˜ ìˆì—ˆì„ ê²ƒì´ë‹¤. ê·¸ëŸ°ë° ë¬¸ì œëŠ” ì •ì ë“¤ì„ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ë¼ê³  ìš”êµ¬í•˜ê³  ìˆë‹¤. ê·¸ë˜ì„œ ì–´ë–»ê²Œ í•´ì•¼ í•  ì§€ ê°ì´ ì˜ ì¡íˆì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ ë‹¨ìˆœíˆ í•œ ë²ˆ MSTë¥¼ ìˆ˜í–‰í•´ ë³´ì.</p>
<div>
<img width="48%" alt="image" src="https://github.com/user-attachments/assets/6eac02c3-5971-4059-8d4f-725a72bd7762" style="display : inline"/>
<img width="48%" alt="image" src="https://github.com/user-attachments/assets/995dba18-306f-4a70-bb78-bcc64f3755a2" style="display : inline" />
</div>

<p>MSTë¥¼ ìˆ˜í–‰í•´ì„œ ì–»ì€ íŠ¸ë¦¬ì—ì„œ, ì–´ë–¤ ë‹¨ìˆœí•œ ì‘ì—…ì„ í†µí•´ ê°€ì¤‘ì¹˜ì˜ í•©ì˜ ìµœì†Œë¥¼ ìœ ì§€í•˜ë©´ì„œ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆì„ê¹Œ? MSTì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§„ ê°„ì„ ì„ ì œê±°í•´ ë³´ë©´ ì–´ë–¨ê¹Œ?</p>
<img width="100%" alt="image" src="https://github.com/user-attachments/assets/8e3edd44-60ba-46bb-b561-1cd5f93afe79" />

<p>ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì°¸ê³ ë¡œ íŠ¸ë¦¬ì˜ ê°„ì„  í•˜ë‚˜ë¥¼ ì œê±°í•˜ë©´, íŠ¸ë¦¬ëŠ” ì •í™•íˆ ë‘ ê°œì˜ ë¶€ë¶„ íŠ¸ë¦¬ë¡œ ë‚˜ë‰˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤. ë˜í•œ ì´ ë¬¸ì œëŠ” $N$ê°œì˜ ë…¸ë“œë¥¼ 2ê°œì˜ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ë¬¸ì œì˜€ì§€ë§Œ, ë§Œì•½ $K$ê°œì˜ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì•¼ í•œë‹¤ë©´ MSTì—ì„œ ê°€ì¥ ê°€ì¤‘ì¹˜ê°€ í° ê°„ì„  $K-1$ê°œë¥¼ ì œê±°í•˜ë©´ ëœë‹¤ëŠ” ê²ƒì„ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>
<p><a href="https://www.acmicpc.net/problem/1647">ğŸ”— ë¬¸ì œ ë§í¬</a></p>
<h2>ì½”ë“œ</h2>
<p>ê°„ì„ ì„ í‘œí˜„í•˜ê¸° ìœ„í•œ í´ë˜ìŠ¤ <code>Pair</code>ì„ ì •ì˜í•œë‹¤.</p>
<pre><code class="language-java">static class Pair {
    int x; long y;
    public Pair(int x, long y) {this.x = x; this.y = y;}
}
</code></pre>
<p>ì •ì ì˜ ìˆ˜ <code>N</code>ê³¼ ê°„ì„ ì˜ ìˆ˜ <code>M</code>ì„ ì…ë ¥ë°›ì€ ë’¤ ê·¸ë˜í”„ë¥¼ ë‹´ì„ ë³€ìˆ˜ <code>graph</code>ë¥¼ ì„ ì–¸í•œë‹¤. <code>graph</code>ì˜ ê° ì›ì†Œë¥¼ <code>ArrayList</code>ë¡œ ì´ˆê¸°í™”í•˜ê³ , ê°„ì„ ì„ ì…ë ¥ë°›ëŠ”ë‹¤. ëŒ€ì¹­ ê·¸ë˜í”„ì´ë¯€ë¡œ ê°„ì„ ì€ ê° ì •ì ì— ëŒ€ì¹­ìœ¼ë¡œ ì¶”ê°€í•´ì•¼ í•œë‹¤.</p>
<pre><code class="language-java">public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    int N = Integer.parseInt(st.nextToken());
    int M = Integer.parseInt(st.nextToken());

    @SuppressWarnings(&quot;unchecked&quot;)
    List&lt;Pair&gt;[] graph = new List[N+1];

    for (int i = 1; i &lt;= N; i++)
        graph[i] = new ArrayList&lt;&gt;();

    for (int i = 0; i &lt; M; i++) {
        st = new StringTokenizer(br.readLine());

        int a, b, w;
        a = Integer.parseInt(st.nextToken());
        b = Integer.parseInt(st.nextToken());
        w = Integer.parseInt(st.nextToken());

        graph[a].add(new Pair(b, w));
        graph[b].add(new Pair(a, w));
    }
</code></pre>
<p>ì •ì  ë°©ë¬¸ì„ ì²´í¬í•  <code>visited</code> ë³€ìˆ˜ì™€, ê°€ì¤‘ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ê°„ì„ ì„ ì •ë ¬í•˜ê¸° ìœ„í•œ ìš°ì„ ìˆœìœ„ í <code>pq</code>ë¥¼ ì„ ì–¸í•œë‹¤. ë˜í•œ ìµœì†Œì‹ ì¥íŠ¸ë¦¬ì˜ ê°€ì¤‘ì¹˜ í•©ì„ ì €ì¥í•  <code>mstWeight</code>ì™€ ìµœì†Œì‹ ì¥íŠ¸ë¦¬ì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê¸°ë¡í•  <code>maxWeight</code> ë³€ìˆ˜ë¥¼ ì„ ì–¸í•´ ë‘”ë‹¤. <code>count</code>ëŠ” í˜„ì¬ í™•ì •í•œ ê°„ì„ ì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì„ ì–¸í•˜ì˜€ë‹¤. </p>
<p>ë³€ìˆ˜ë¥¼ ëª¨ë‘ ì„ ì–¸í•˜ë©´ ì •ì  1ë¶€í„° í”„ë¦¼ ì•Œê³ ë¦¬ì¦˜ì„ ìˆ˜í–‰í•œë‹¤. ì¼ë°˜ì ì¸ í”„ë¦¼ ì•Œê³ ë¦¬ì¦˜ê³¼ í¬ê²Œ ë‹¤ë¥¸ ê²ƒì€ ì—†ìœ¼ë‚˜ ê°„ì„ ì´ í™•ì •ë  ë•Œë§ˆë‹¤ maxWeightë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì— ì£¼ëª©í•˜ì.</p>
<pre><code class="language-java">    boolean[] visited = new boolean[N+1];
    PriorityQueue&lt;Pair&gt; pq = new PriorityQueue&lt;&gt;((a,b)-&gt;Long.compare(a.y, b.y));
    pq.offer(new Pair(1, 0));
    long mstWeight = 0;
    long maxWeight = 0;
    int count = 0;
    while (!pq.isEmpty()) {
        Pair s = pq.poll();
        if (visited[s.x]) continue;
        mstWeight += s.y;
        if (s.y &gt; maxWeight) maxWeight = s.y;
        visited[s.x] = true;
        
        if (count++ == N-1) break;

        for (Pair adj : graph[s.x]) {
            if (visited[adj.x]) continue;
            pq.offer(adj);
        }
    }
</code></pre>
<p>ë°˜ë³µë¬¸ì—ì„œ ë¹ ì ¸ë‚˜ì˜¤ë©´ MSTì˜ ê°€ì¤‘ì¹˜ ì´í•©ê³¼ MSTì— ë“¤ì–´ìˆëŠ” ê°„ì„ ì˜ ìµœëŒ€ ê°€ì¤‘ì¹˜ê°€ ëª¨ë‘ í™•ì •ëœ ê²ƒì´ë‹¤. ì•ì„œ ì„¤ëª…í–ˆë“¯ <code>mstWeight - maxWeight</code>ì„ í†µí•´ ë¬¸ì œê°€ ì›í•˜ëŠ” ë‹µì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ê°’ì„ ì¶œë ¥í•˜ê³  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•œë‹¤.</p>
<pre><code class="language-java">    System.out.println(mstWeight-maxWeight);
}
</code></pre>
<h2>ì „ì²´ ì½”ë“œ</h2>
<pre><code class="language-java">import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    static class Pair {
        int x; long y;
        public Pair(int x, long y) {this.x = x; this.y = y;}
    }

    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        int N = Integer.parseInt(st.nextToken());
        int M = Integer.parseInt(st.nextToken());

        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;Pair&gt;[] graph = new List[N+1];

        for (int i = 1; i &lt;= N; i++)
            graph[i] = new ArrayList&lt;&gt;();

        for (int i = 0; i &lt; M; i++) {
            st = new StringTokenizer(br.readLine());

            int a, b, w;
            a = Integer.parseInt(st.nextToken());
            b = Integer.parseInt(st.nextToken());
            w = Integer.parseInt(st.nextToken());

            graph[a].add(new Pair(b, w));
            graph[b].add(new Pair(a, w));
        }

        boolean[] visited = new boolean[N+1];
        PriorityQueue&lt;Pair&gt; pq = new PriorityQueue&lt;&gt;((a,b)-&gt;Long.compare(a.y, b.y));
        pq.offer(new Pair(1, 0));
        long mstWeight = 0;
        long maxWeight = 0;
        int count = 0;
        while (!pq.isEmpty()) {
            Pair s = pq.poll();
            if (visited[s.x]) continue;
            mstWeight += s.y;
            if (s.y &gt; maxWeight) maxWeight = s.y;
            visited[s.x] = true;
            
            if (count++ == N-1) break;

            for (Pair adj : graph[s.x]) {
                if (visited[adj.x]) continue;
                pq.offer(adj);
            }
        }

        System.out.println(mstWeight-maxWeight);
    }
}
</code></pre>
<h2>ì‹œê°„ë³µì¡ë„</h2>
<p>í”„ë¦¼ ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O(E \log E)$ì´ë¯€ë¡œ ì´ ì½”ë“œì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O(M \log M)$ì´ë‹¤. ì´ ë¬¸ì œì—ì„œ $1 \le M \le 1,000,000$ì´ë¯€ë¡œ ìµœì•…ì˜ ê²½ìš° ì•½ 2ì²œë§Œë²ˆ ì—°ì‚°í•˜ë¯€ë¡œ 2ì´ˆ ë‚´ì— ì¶©ë¶„íˆ í†µê³¼í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>

        <script>
          location.href = "/post-view?href=posts%2FPS%2F2026-01-28-%EB%B0%B1%EC%A4%80-1647-%EB%8F%84%EC%8B%9C-%EB%B6%84%ED%95%A0-%EA%B3%84%ED%9A%8D.md"
        </script>
      </body>
  