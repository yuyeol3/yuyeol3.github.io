# 17070 - íŒŒì´í”„ ì˜®ê¸°ê¸° 1

ì´ ë¬¸ì œëŠ” (1,1), (1,2)ë¥¼ ê°€ë¡œ ë°©í–¥ìœ¼ë¡œ ì°¨ì§€í•˜ê³  ìˆëŠ” íŒŒì´í”„ì˜ í•œ ìª½ ëì„ ì •í•´ì§„ ë°©ë²•ë§Œì„ ì´ìš©í•´ (N, N)ê¹Œì§€ ì˜®ê¸¸ ìˆ˜ ìˆëŠ” ê²½ìš°ì˜ ìˆ˜ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œì´ë‹¤. ë‹¤ë§Œ ê³µê°„ì— ë²½ì´ ìˆì„ ê²½ìš°, ê·¸ ë²½ì— íŒŒì´í”„ê°€ ë‹¿ì§€ ì•Šë„ë¡ í•´ì•¼ í•œë‹¤. 

ë˜í•œ íŒŒì´í”„ì˜ ë°©í–¥ë³„ë¡œ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë‹¤ë¥´ë‹¤. ì•„ë˜ ê·¸ë¦¼ì€ ê° ë°©í–¥ë³„ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ëª¨ë‘ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤. ìƒ‰ì¹ ëœ ì¹¸ì€ ë²½ì´ ì—†ì–´ì•¼ í•˜ëŠ” ê³³ì´ë‹¤.

<center>

<img width="1037" height="829" alt="image" src="https://github.com/user-attachments/assets/67985b4d-0ce2-4d86-b78f-f11190685cd1" />

</center>

ì´ ë¬¸ì œëŠ” ë¸Œë£¨íŠ¸ í¬ìŠ¤ì™€ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ëª¨ë‘ í’€ ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ DP ë°©ì‹ì˜ ê²½ìš° íŒŒì´í”„ ì˜®ê¸°ê¸° 2ì—ì„œ ë”°ë¡œ ë‹¤ë£¨ê³  ì—¬ê¸°ì„œëŠ” ë¸Œë£¨íŠ¸ í¬ìŠ¤ ë°©ì‹ìœ¼ë¡œë§Œ í’€ì–´ë³¼ ê²ƒì´ë‹¤.

[ğŸ”— ë¬¸ì œ ë§í¬](https://www.acmicpc.net/problem/17070)

## ì½”ë“œ

ë¨¼ì € íƒìƒ‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚¼ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤. ë°©í–¥ì„ í‘œì‹œí•  ë³€ìˆ˜ `dir`ê³¼ ìƒíƒœì˜ ìœ„ì¹˜(í–‰, ì—´)ë¥¼ ë‚˜íƒ€ë‚¼ `r`, `c` ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤.
```java
static class State {
    public int dir;  // 1 : ê°€ë¡œ, 2 : ì„¸ë¡œ, 3 : ëŒ€ê°ì„ 
    public int r, c;

    public State(int r, int c, int dir) {
        this.r = r;
        this.c = c;
        this.dir = dir;
    }
}
```

ë‹¤ìŒìœ¼ë¡œ ìœ„ì¹˜ íƒìƒ‰ì„ ì‰½ê²Œ í•˜ê¸° ìœ„í•´ dr, dc ë°°ì—´ì„ ì„ ì–¸í•œë‹¤. 0ë²ˆì§¸ëŠ” `dir` ë³€ìˆ˜ ê°’ê³¼ ë°°ì—´ì˜ ê°’ì„ ë§ì¶°ì£¼ê¸° ìœ„í•œ ì›ì†Œë¡œ, ì‹¤ì œë¡œ ì‚¬ìš©ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. 1ë²ˆì§¸ëŠ” ê°€ë¡œ ì´ë™ ë°©í–¥, 2ë²ˆì§¸ëŠ” ì„¸ë¡œ ì´ë™ ë°©í–¥, 3ë²ˆì§¸ëŠ” ëŒ€ê°ì„  ì´ë™ ë°©í–¥ì´ë‹¤.

```java
static int[] dr = {0, 0, 1, 1};
static int[] dc = {0, 1, 0, 1};
```

ì´ì œ main í•¨ìˆ˜ì—ì„œ ì§‘ì˜ í¬ê¸°ì™€ ì§‘ì˜ ìƒíƒœë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ë°°ì—´ì€ (N+5)x(N+5) í¬ê¸°ë¡œ ë„‰ë„‰í•˜ê²Œ ì¡ëŠ”ë‹¤.

```java
public static void main(String[] args) throws IOException {
    int N = Integer.parseInt(br.readLine());

    int arr[][] = new int[N+5][N+5];

    StringTokenizer st;
    for (int i = 1; i <= N; i++) {
        st = new StringTokenizer(br.readLine());
        for (int j = 1; j <= N; j++) {
            arr[i][j] = Integer.parseInt(st.nextToken());
        }
    }
```
íƒìƒ‰ì„ ìœ„í•´ ìŠ¤íƒì²˜ëŸ¼ ì“¸ dequeë¥¼ í•˜ë‚˜ ë§Œë“¤ê³  ìµœì´ˆ ìƒíƒœì¸ (1,2), ê°€ë¡œë°©í–¥ì„ íì˜ ì•ì— ì‚½ì…í•œë‹¤. ê²½ìš°ì˜ ìˆ˜ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ `result` ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ê³  0ìœ¼ë¡œ ì´ˆê¸°í™”í•œë‹¤.

```java
    Deque<State> dq = new ArrayDeque<>();
    dq.addFirst(new State(1, 2, 1));
    int result = 0;
```

ì´ì œ `dq`ê°€ ë¹„ì–´ìˆì„ ë•Œê¹Œì§€ ë°˜ë³µë¬¸ì„ ëˆë‹¤. ë°˜ë³µë¬¸ ë‚´ì—ì„œ ë¨¼ì € ê°€ì¥ ì•ì— ìˆëŠ” ìƒíƒœ së¥¼ `dq`ì—ì„œ êº¼ë‚¸ë‹¤. ë§Œì•½ ìƒíƒœì˜ í–‰ê³¼ ì—´ì´ ëª¨ë‘ Nê³¼ ê°™ë‹¤ë©´ (N,N)ì— ì˜¤ëŠ” ë°©ë²•ì— í•´ë‹¹í•˜ë¯€ë¡œ `result++`í•˜ê³  ì¸ì ‘ ìƒíƒœ íƒìƒ‰ì„ ê±´ë„ˆë›´ë‹¤. 

(N,N)ì´ ì•„ë‹ˆë¼ë©´ forë¬¸ì„ ëŒë©´ì„œ ê°€ëŠ¥í•œ ë‹¤ìŒ ìƒíƒœë¥¼ ëª¨ë‘ íƒìƒ‰í•œë‹¤. ë¨¼ì € í˜„ì¬ ìƒíƒœì˜ ì´ë™ ë°©í–¥ê³¼ ì•ìœ¼ë¡œ ì´ë™í•  ë°©í–¥ì„ í™•ì¸í•´ ì´ë™ì´ ê°€ëŠ¥í•œ ë°©í–¥ì¸ì§€ ê²€ì‚¬í•œë‹¤. ì´ë™ ê°€ëŠ¥í•œ ë°©í–¥ì´ë¼ë©´ `cr`, `cc` ë³€ìˆ˜ë¥¼ ì •ì˜í•´ ë‹¤ìŒ í–‰ ìœ„ì¹˜ì™€ ì—´ ìœ„ì¹˜ë¡œ ì´ˆê¸°í™”í•œ ë‹¤ìŒ, ë²”ìœ„ë¥¼ ê²€ì‚¬í•œë‹¤. ê·¸ë¦¬ê³  ì§‘ ìƒíƒœë¥¼ ê²€ì‚¬í•´ ë²½ì´ ì—†ëŠ” ê²ƒì´ ë§ëŠ”ì§€ í™•ì¸í•œë‹¤. 

ëŒ€ê°ì„  ì´ë™ì˜ ê²½ìš° `cr`, `cc` ë¿ ì•„ë‹ˆë¼ ìœ„, ì•„ë˜ë„ ê²€ì‚¬í•´ì•¼ í•˜ë¯€ë¡œ `dir==3`ì´ë©´ `(arr[cr-1][cc] > 0 || arr[cr][cc-1] > 0)`ì— í•´ë‹¹ë˜ëŠ”ì§€ ê²€ì‚¬í•´ì¤€ë‹¤.

ê²€ì‚¬ë¥¼ ëª¨ë‘ í†µê³¼í–ˆë‹¤ë©´ ìœ íš¨í•œ ë‹¤ìŒ ìƒíƒœì´ë¯€ë¡œ `dq`ì˜ ì²˜ìŒì— ìƒíƒœë¥¼ ì‚½ì…í•´ì¤€ë‹¤.

```java
    while (!dq.isEmpty()) {
        State s = dq.poll();
        if (s.r == N && s.c == N) {
            result++;
            continue;
        }

        for (int dir = 1; dir <= 3; dir++) {
            // ë°©í–¥ ê²€ì‚¬
            if (s.dir == 1 && dir == 2) continue;
            if (s.dir == 2 && dir == 1) continue;

            int cr = s.r + dr[dir];
            int cc = s.c + dc[dir];

            if (cr < 1 || cr > N) continue;
            if (cc < 1 || cc > N) continue;
            if (arr[cr][cc] > 0) continue;
            if (dir == 3 && (arr[cr-1][cc] > 0 || arr[cr][cc-1] > 0))
                continue;


            dq.addFirst(new State(cr, cc, dir));
        }

    }
```

while ë¬¸ì„ ë¹ ì ¸ë‚˜ì™”ë‹¤ë©´ íƒìƒ‰ì´ ì¢…ë£Œëœ ê²ƒì´ë¯€ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ê³  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•œë‹¤.

```java
    bw.write(result + "\n");
    bw.flush();
}
```

## ì „ì²´ ì½”ë“œ

```java
import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    static BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));

    static class State {
        public int dir;  // 1 : ê°€ë¡œ, 2 : ì„¸ë¡œ, 3 : ëŒ€ê°ì„ 
        public int r, c;

        public State(int r, int c, int dir) {
            this.r = r;
            this.c = c;
            this.dir = dir;
        }
    }

    static int[] dr = {0, 0, 1, 1};
    static int[] dc = {0, 1, 0, 1};

    public static void main(String[] args) throws IOException {
        int N = Integer.parseInt(br.readLine());

        int arr[][] = new int[N+5][N+5];

        StringTokenizer st;
        for (int i = 1; i <= N; i++) {
            st = new StringTokenizer(br.readLine());
            for (int j = 1; j <= N; j++) {
                arr[i][j] = Integer.parseInt(st.nextToken());
            }
        }

        Deque<State> dq = new ArrayDeque<>();
        dq.addFirst(new State(1, 2, 1));
        int result = 0;

        while (!dq.isEmpty()) {
            State s = dq.poll();
            if (s.r == N && s.c == N) {
                result++;
                continue;
            }

            for (int dir = 1; dir <= 3; dir++) {
                if (s.dir == 1 && dir == 2) continue;
                if (s.dir == 2 && dir == 1) continue;

                int cr = s.r + dr[dir];
                int cc = s.c + dc[dir];

                if (cr < 1 || cr > N) continue;
                if (cc < 1 || cc > N) continue;
                if (arr[cr][cc] > 0) continue;
                if (dir == 3 && (arr[cr-1][cc] > 0 || arr[cr][cc-1] > 0))
                    continue;


                dq.addFirst(new State(cr, cc, dir));
            }

        }

        bw.write(result + "\n");
        bw.flush();
    }
}
```

## ì‹œê°„ë³µì¡ë„

ëŒ€ëµì ìœ¼ë¡œ ê³„ì‚°í•´ë³´ë©´ í•œ ìƒíƒœë‹¹ ì¸ì ‘í•œ ìƒíƒœì˜ ìˆ˜ëŠ” 3ê°œì”© í™•ì¥ë˜ë¯€ë¡œ ì§€ìˆ˜ì ìœ¼ë¡œ 3ë°°ì”© ëŠ˜ì–´ë‚˜ $O(3^N)$ì´ ëœë‹¤. ì´ ë¬¸ì œì—ì„œëŠ” $N \le 16$ ì´ë¯€ë¡œ $3^{16} \approx 4300$ë§ŒíšŒ ì´ë¯€ë¡œ 1ì´ˆ ë‚´ì— ë¬¸ì œë¥¼ í†µê³¼í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ íŒŒì´í”„ ì˜®ê¸°ê¸° 2ì˜ ê²½ìš° $N \le 32$ ì´ê³  0.5 ì´ˆ ë‚´ì— í†µê³¼í•´ì•¼ í•˜ë¯€ë¡œ ë¸Œë£¨íŠ¸í¬ìŠ¤ ë°©ë²•ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
