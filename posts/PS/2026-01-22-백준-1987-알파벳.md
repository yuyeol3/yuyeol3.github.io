# 1987 - ì•ŒíŒŒë²³

ì´ ë¬¸ì œëŠ” ë³´ë“œì˜ í¬ê¸°ì™€ ì•ŒíŒŒë²³ì´ ì íŒ ë³´ë“œê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ê°™ì€ ì•ŒíŒŒë²³ì„ ë‘ ë²ˆ ì´ìƒ í¬í•¨í•˜ì§€ ì•Šìœ¼ë©´ì„œ ê°€ì¥ ë©€ë¦¬ ê°ˆ ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì°¾ëŠ” ë¬¸ì œì´ë‹¤.

ì–¼í• ë³´ë©´ BFS ìµœë‹¨ê±°ë¦¬ ë¬¸ì œì²˜ëŸ¼ ë³´ì¼ ìˆ˜ ìˆì§€ë§Œ, ì‚¬ì‹¤ì€ ë°±íŠ¸ë˜í‚¹ ë¬¸ì œì´ë‹¤. ì´ ë¬¸ì œì˜ ê²½ìš° ê²½ë¡œë³„ë¡œ ë°©ë¬¸í•œ ì•ŒíŒŒë²³ì˜ ì¢…ë¥˜ê°€ ë‹¤ë¥´ê³ , ìƒíƒœë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë°±íŠ¸ë˜í‚¹ìœ¼ë¡œ í’€ì–´ì•¼ í•œë‹¤.

[ğŸ”— ë¬¸ì œ ë§í¬](https://boj.kr/1987)

## ì½”ë“œ

í•„ìš”í•œ ë³€ìˆ˜ë“¤ì„ ë¨¼ì € ì„ ì–¸í•œë‹¤. `dx`, `dy`ì˜ ê²½ìš° ê²©ìíŒì—ì„œ ìƒíƒœì˜ ì´ë™ì„ ì‰½ê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì •ì˜í•œ ë°°ì—´ë¡œ, ê°ê° ì•„ë˜ìª½, ì˜¤ë¥¸ìª½, ìœ„ìª½, ì™¼ìª½ ì´ë™ë°©í–¥ì„ ì˜ë¯¸í•œë‹¤. `R`, `C`ëŠ” ë³´ë“œì˜ ì„¸ë¡œ, ê°€ë¡œ í¬ê¸°ì´ë‹¤. ë˜í•œ `board`ì—ëŠ” í–‰ë³„ë¡œ ê°€ì§€ê³  ìˆëŠ” ì•ŒíŒŒë²³ì˜ ë¬¸ìì—´ì„ ì €ì¥í•œë‹¤. `maximum`ì€ ë§ì´ ì§€ë‚  ìˆ˜ ìˆëŠ” ìµœëŒ€ì˜ ì¹¸ ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜ì´ë‹¤.



```java
class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    static int[] dx = {1, 0, -1, 0};
    static int[] dy = {0, 1, 0, -1};
    static int R, C;
    static String[] board;
    static int maximum = 0;
```

main í•¨ìˆ˜ì—ì„œ ë³´ë“œì˜ í¬ê¸°ë¥¼ ë¨¼ì € ì…ë ¥ë°›ì€ ë’¤ `board` ë°°ì—´ì˜ í¬ê¸°ë¥¼ `R`ë¡œ ì¡ëŠ”ë‹¤. ê·¸ëŸ° ë‹¤ìŒ í–‰ë³„ë¡œ ë¬¸ìì—´ì„ ì…ë ¥ë°›ì•„ `board`ì— ì €ì¥í•œë‹¤.

```java
public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    R = Integer.parseInt(st.nextToken());
    C = Integer.parseInt(st.nextToken());

    board = new String[R];

    for (int i = 0; i < R; i++) {
        board[i] = br.readLine();
    }
```

ë‹¤ìŒìœ¼ë¡œ ë¯¸ë¦¬ ì •ì˜í•´ë‘” dfs í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. ë¬¸ì œì—ì„œ ë§ì€ ì¢Œì¸¡ ìƒë‹¨ì— ìˆë‹¤ê³  í•˜ì˜€ìœ¼ë¯€ë¡œ (0, 0) ë¶€í„° ì‹œì‘í•˜ê³ , (0,0)ì— ìˆëŠ” ì•ŒíŒŒë²³ì€ ë°©ë¬¸ì²˜ë¦¬ë¥¼ í•´ì•¼ í•˜ë¯€ë¡œ ë¹„íŠ¸ë§ˆìŠ¤í‚¹ì„ ì‚¬ìš©í•´ `1 << (board[0].charAt(0) - 'A')` ë¡œ í•´ë‹¹ ì•ŒíŒŒë²³ì˜ ë¹„íŠ¸ë¥¼ 1ë¡œ ì¡°ì‘í•´ì¤€ë‹¤.

```java
    dfs(
        0, 0, 
        (1 << (board[0].charAt(0) - 'A')), 
        1
    );
```

dfs í•¨ìˆ˜ì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë¨¼ì € `dist`ê°€ `maximum`ë³´ë‹¤ í¬ë‹¤ë©´ ìµœëŒ€ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤. ë˜í•œ `maximum`ì´ ì´ë¯¸ 26ì´ë¼ë©´ ë” ì´ìƒ íƒìƒ‰í•´ë„ `dist`ê°€ ì»¤ì§ˆ ê°€ëŠ¥ì„±ì´ ì—†ìœ¼ë¯€ë¡œ returní•œë‹¤. (ì•ŒíŒŒë²³ì˜ ê°œìˆ˜ëŠ” 26ê°œì´ê³  ê° ì•ŒíŒŒë²³ì€ ì „ì²´ ê²½ë¡œì— í•œ ë²ˆì”©ë§Œ ë“±ì¥í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê²½ë¡œì˜ ìµœëŒ€ ê¸¸ì´ëŠ” 26ì´ë‹¤.)

ë˜í•œ í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì•ŒíŒŒë²³ê³¼ í˜„ì¬ ê±°ë¦¬ë¥¼ ë”í–ˆì„ ë•Œ ìµœëŒ€ê°’ë³´ë‹¤ ì‘ë‹¤ë©´ ìœ ë§í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê°€ì§€ì¹˜ê¸°(return)í•œë‹¤.

ìœ„ ì¡°ê±´ì„ ëª¨ë‘ í†µê³¼í–ˆë‹¤ë©´ ë‹¤ìŒ ìƒíƒœë¥¼ íƒìƒ‰í•œë‹¤. í˜„ì¬ì˜ ìƒíƒœì—ì„œ ë°©ë¬¸ ê°€ëŠ¥í•œ ë°©í–¥ì€ ìµœëŒ€ 4ê°œì´ë‹¤. ê·¸ëŸ°ë° ë°©ë¬¸í–ˆë˜ ê²½ë¡œì˜ ì—­ë°©í–¥ìœ¼ë¡œëŠ” ë‹¹ì—°íˆ ê°ˆ ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ ê²°ë¡ ì ìœ¼ë¡œëŠ” ìµœëŒ€ 3ê°œì˜ ë°©í–¥ì„ íƒìƒ‰í•˜ê²Œ ëœë‹¤. 

ê° ë°©í–¥ë³„ë¡œ `nx = x + dx[i]`, `ny = y + dy[i]`ë¥¼ í†µí•´ ë‹¤ìŒ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ê³ , ì´ ìœ„ì¹˜ê°€ ë³´ë“œ ë²”ìœ„ ë‚´ì¸ì§€ í™•ì¸í•œë‹¤. ë§Œì•½ ë³´ë“œ ë²”ìœ„ ë‚´ë¼ë©´, ë‹¤ìŒ ìœ„ì¹˜ì— ìˆëŠ” ì•ŒíŒŒë²³ì´ ê²½ë¡œì— ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. ë‘ ì¡°ê±´ ëª¨ë‘ ë¬¸ì œê°€ ì—†ë‹¤ë©´ dfs í•¨ìˆ˜ë¥¼ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤. 

ë‹¤ìŒ ìœ„ì¹˜ì¸ `nx, ny`ë¥¼ ì¸ìì— ë„£ëŠ”ë‹¤. ë˜í•œ ë‹¤ìŒ ìœ„ì¹˜ì— ìˆëŠ” ì•ŒíŒŒë²³ì— ëŒ€í•œ ë°©ë¬¸ ì²˜ë¦¬ë„ í•´ì•¼ í•˜ë¯€ë¡œ `mask | (1 << (board[nx].charAt(ny) - 'A'))` ë¥¼ í†µí•´ ì•ŒíŒŒë²³ì˜ ë¹„íŠ¸ë¥¼ 1ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤. ê±°ë¦¬ë„ 1 ì¦ê°€í•œ ê²ƒì´ë¯€ë¡œ `dist+1`ì„ ì¸ìì— ë„£ì–´ ì¤€ë‹¤.

```java
public static void dfs(int x, int y, int mask, int dist) {
    if (dist > maximum) maximum = dist;
    if (maximum == 26) return;


    for (int i = 0; i < 4; i++) {
        int nx = x + dx[i];
        int ny = y + dy[i];

        if (nx < 0 || nx >= R || ny < 0 || ny >= C) continue;
        if (((mask >> (board[nx].charAt(ny) - 'A')) & 1) == 1) continue;

        dfs(nx, ny, mask | (1 << (board[nx].charAt(ny) - 'A')), dist+1);
    }
}
```

dfsë¥¼ ì™„ë£Œí•˜ë©´ maximumì— ë§ì´ ê°ˆ ìˆ˜ ìˆëŠ” ìµœì¥ ê²½ë¡œê°€ ì €ì¥ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ê³  í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•œë‹¤. 

```java
    System.out.println(maximum);
}
```
## ì „ì²´ ì½”ë“œ

```java
import java.io.*;
import java.util.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    static int[] dx = {1, 0, -1, 0};
    static int[] dy = {0, 1, 0, -1};
    static int R, C;
    static String[] board;
    static int maximum = 0;
    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        R = Integer.parseInt(st.nextToken());
        C = Integer.parseInt(st.nextToken());

        board = new String[R];

        for (int i = 0; i < R; i++) {
            board[i] = br.readLine();
        }

        dfs(0, 0, (1 << (board[0].charAt(0) - 'A')), 1);

        System.out.println(maximum);
    }

    public static void dfs(int x, int y, int mask, int dist) {
        if (dist > maximum) maximum = dist;
        if (maximum == 26) return;

        for (int i = 0; i < 4; i++) {
            int nx = x + dx[i];
            int ny = y + dy[i];

            if (nx < 0 || nx >= R || ny < 0 || ny >= C) continue;
            if (((mask >> (board[nx].charAt(ny) - 'A')) & 1) == 1) continue;

            dfs(nx, ny, mask | (1 << (board[nx].charAt(ny) - 'A')), dist+1);
        }
    }
}
```

## ì‹œê°„ë³µì¡ë„

ì•ì„œ ë§í–ˆë“¯ ì´ ë¬¸ì œëŠ” ì‚¬ì‹¤ìƒ ë°±íŠ¸ë˜í‚¹ì´ë‹¤. ê° ë‹¨ê³„ë³„ë¡œ ì„ íƒí•  ìˆ˜ ìˆëŠ” ë¶„ê¸°ëŠ” 3ê°œì´ê³  ë‹¨ê³„ëŠ” ì•„ë¬´ë¦¬ ì»¤ë„ ì•ŒíŒŒë²³ ê°œìˆ˜ì˜ ì œí•œ ë•Œë¬¸ì— 26ê°œì´ë‹¤. ë³´ë“œ ì¹¸ì˜ í¬ê¸°ê°€ 26ê°œë³´ë‹¤ ì‘ë‹¤ë©´ ë‹¨ê³„ëŠ” $RC$ ê°œì¼ ê²ƒì´ë‹¤. ë”°ë¼ì„œ ì´ë¥¼ ì‹ìœ¼ë¡œ ì˜®ê¸°ë©´ $O(3^{\min(26, RC)})$ì´ë‹¤. 

ìµœì•…ì˜ ê²½ìš° ì—°ì‚° íšŸìˆ˜ëŠ” ëŒ€ëµ $3^{26}$ì´ê³  ì´ëŠ” 2ì¡°ë¡œ ë§¤ìš° í¬ë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì´ ë¬¸ì œì—ì„œëŠ” ì•ŒíŒŒë²³ ê°œìˆ˜ì— ë”°ë¼ ë°©ë¬¸í•  ìˆ˜ ìˆëŠ” ì¸ì ‘ ë…¸ë“œê°€ ê¸‰ê²©íˆ ì¤„ì–´ë“ ë‹¤. ë”°ë¼ì„œ ë¬¸ì œë¥¼ 2ì´ˆ ë‚´ì— í†µê³¼í•  ìˆ˜ ìˆë‹¤.