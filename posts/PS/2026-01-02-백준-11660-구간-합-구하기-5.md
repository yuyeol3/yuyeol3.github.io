# 11660 - êµ¬ê°„ í•© êµ¬í•˜ê¸°

ì´ ë¬¸ì œëŠ” 2ì°¨ì› ëˆ„ì  í•©ì„ ì˜ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤. ë¬¸ì œ ë‚´ìš©ì„ ì‚´í´ë³´ë©´, $N \times N$ í¬ê¸°ì˜ 2ì°¨ì› í‘œë¥¼ ì…ë ¥ë°›ì•„ $M$ê°œì˜ 2ì°¨ì› êµ¬ê°„í•©ì„ êµ¬í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤. ê·¸ëŸ°ë° ë§Œì•½ í‘œë¥¼ ì…ë ¥ë°›ì•„ ìˆœíšŒí•˜ë©° í•©ì„ êµ¬í•˜ëŠ” ë¸Œë£¨íŠ¸í¬ìŠ¤ ë°©ì‹ìœ¼ë¡œ ë‹¨ìˆœíˆ êµ¬í˜„í•˜ë©´ ìµœì•…ì˜ ê²½ìš° `100000 * 1024 * 1024`ë²ˆ(1ì²œì–µ ë²ˆ) ì—°ì‚°í•˜ë¯€ë¡œ ì‹œê°„ì´ˆê³¼ê°€ ë‚  ê²ƒì´ë‹¤. 

ë”°ë¼ì„œ ì•ì„œ ë§í–ˆë“¯ ì´ ë¬¸ì œë¥¼ í’€ë ¤ë©´ 2ì°¨ì› ëˆ„ì  í•©ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ëˆ„ì í•© í…Œì´ë¸”ì˜ $(i, j)$ ë²ˆì§¸ ì›ì†Œë¥¼ $(1,1)$ ë¶€í„° $(i, j)$ ê¹Œì§€ ëª¨ë“  ì›ì†Œë“¤ì˜ í•©ìœ¼ë¡œ ì •ì˜í•˜ì. ê·¸ë ‡ë‹¤ë©´ $(i, j)$ ë²ˆì§¸ ëˆ„ì í•© ì›ì†ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì–»ì„ ìˆ˜ ìˆë‹¤.

$$\text{prefixSum}[i][j] = \text{table}[i][j] + \text{prefixSum}[i-1][j] + \text{prefixSum}[i][j-1] - \text{prefixSum}[i-1][j-1] $$

ì—¬ê¸°ì„œ ë§ˆì§€ë§‰ í•­ì— $- \text{prefixSum}[i-1][j-1]$ê°€ ë¶™ì€ ì´ìœ ëŠ” $\text{prefixSum}[i-1][j] + \text{prefixSum}[i][j-1]$ ì„ ë”í•˜ë©´ prefixSumì˜ $(i-1, j-1)$ë²ˆì§¸ ì›ì†ŒëŠ” ë‘ ë²ˆ ë”í•´ì§€ê¸° ë•Œë¬¸ì´ë‹¤. ì´ëŠ” ë§ˆì¹˜ ì§‘í•©ì—ì„œ í•©ì§‘í•©ì˜ ì›ì†Œ ê°œìˆ˜ë¥¼ êµ¬í•  ë•Œ ì“°ëŠ” í¬í•¨-ë°°ì œ ì›ë¦¬ì™€ ìœ ì‚¬í•˜ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.

<img width="192" height="194" alt="image" src="https://github.com/user-attachments/assets/4d0bba1a-38cb-459a-9fdf-93d52c85e063" />

ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ ìœ„ì™€ ê°™ë‹¤. 

ê·¸ë ‡ë‹¤ë©´ ë¬¸ì œì—ì„œ ì›í•˜ëŠ”, íŠ¹ì • êµ¬ê°„ì˜ í•©ì„ ì–»ì„ ë•ŒëŠ” prefixSum í…Œì´ë¸”ì„ ì–´ë–»ê²Œ ì‚¬ìš©í•´ì•¼ í• ê¹Œ? ë¨¼ì € prefixSumì—ì„œ (i, j)ë²ˆì§¸ ì›ì†ŒëŠ” (1,1)ì—ì„œ (i,j) ê¹Œì§€ì˜ êµ¬ê°„í•©ì´ë‹¤. ë¬¸ì œëŠ” (x1, y1) ~ (x2, y2)ì˜ ì›ì†Œë“¤ì˜ í•©ì„ ì›í•œë‹¤.  `prefixSum[x2][y2]`ëŠ” (1,1) ~ (x2, y2)ì˜ ê°’ì„ ì¤„ ê²ƒì´ë‹¤. í•´ë‹¹ ì‚¬ê°í˜•ì—ì„œ (x1-1, y2)ì™€ (x2, y1-1)ì„ ì œì™¸í•˜ë©´ ìš°ë¦¬ê°€ ì›í•˜ëŠ” êµ¬ê°„í•©ì—ì„œ `prefixSum[x1-1][y1-1]` ë§Œí¼ ì ì€ ê°’ì„ ì–»ëŠ”ë‹¤. `prefixSum`ì„ ì–»ì„ ë•Œì²˜ëŸ¼ ê·¸ ë¶€ë¶„ì´ ê²¹ì¹˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ (x1-1, y1-1)ë¥¼ í•œ ë²ˆ ë”í•´ì¤˜ì•¼ í•œë‹¤. ì´ë¥¼ ìˆ˜ì‹ìœ¼ë¡œ ì ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤

$$\text{(êµ¬ê°„í•©)} = \text{prefixSum}[x2][y2] - \text{prefixSum}[x1-1][y2] - \text{prefixSum}[x2][y1-1] + \text{prefixSum}[x1-1][y1-1]$$

[ğŸ”— ë¬¸ì œ ë§í¬](https://www.acmicpc.net/problem/11660)

## ì½”ë“œ 
ë¯¸ë¦¬ êµ¬í•´ë‘” ì‹ì„ ë°”íƒ•ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ëœë‹¤.
ë¨¼ì € í•„ìš”í•œ ë³€ìˆ˜ë¥¼ ì •ì˜í•œë‹¤. `table`ëŠ” ì…ë ¥ë°›ì€ í…Œì´ë¸”ì˜ ì›ì†Œë¥¼ ì €ì¥í•´ë‘˜ ë°°ì—´ì´ë©°. `pSum`ì€ ëˆ„ì í•©ì„ ì €ì¥í•´ë‘˜ ë°°ì—´ì´ë‹¤.
```java
class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    static BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
    static int N, M;
    static int[][] table;
    static int[][] pSum;
  // ...
```
ë‹¤ìŒìœ¼ë¡œ main í•¨ìˆ˜ì—ì„œ `N, M`ì„ ì…ë ¥ë°›ê³  `table`ê³¼ `pSum`ì„ ë©”ëª¨ë¦¬ì— í• ë‹¹í•œë‹¤. ë°°ì—´ í¬ê¸°ë¥¼ `N+5`ë¡œ ë‘” ì´ìœ ëŠ” ë¨¼ì € 1 based indexingì„ í•˜ê¸° ìœ„í•¨ê³¼, í˜¹ì‹œë‚˜ ëª¨ë¥¼ ì‹¤ìˆ˜ë¡œ ë°°ì—´ì— ì˜ëª» ì ‘ê·¼í•´ OutOfBound ì˜ˆì™¸ê°€ ë‚˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨ì´ë‹¤. ì°¸ê³ ë¡œ 1 based indexingì„ í•˜ëŠ” ì´ìœ ëŠ” ì•ì„  ìˆ˜ì‹ë“¤ì—ì„œ `i-1`, `j-1`ì„ ê³„ì‚°í•  ë•Œ ië‚˜ jê°€ 0ì¼ ê²½ìš° OOBê°€ ë‚  ìˆ˜ ìˆì–´ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ ë”°ë¡œ í•´ì¤˜ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ 1 based indexingì„ í•˜ë©´ ië‚˜ jê°€ 1ì´ì–´ë„ OOBê°€ ë‚˜ì§€ ì•Šê³ , `arr[i][0]`, `arr[0][j]`ì˜ ê°’ì€ 0ìœ¼ë¡œ ìë™ ì´ˆê¸°í™”ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•  í•„ìš”ê°€ ì—†ë‹¤.
```java
public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    N = Integer.parseInt(st.nextToken());
    M = Integer.parseInt(st.nextToken());

    table = new int[N+5][N+5];
    pSum = new int[N+5][N+5];
  // ...
```
ì´ì œ í…Œì´ë¸”ì˜ ì›ì†Œë¥¼ ì…ë ¥ë°›ì•„ ë„£ì–´ë‘” ë’¤ ëˆ„ì í•©ì„ ê³„ì‚°í•œë‹¤. ì²« ë²ˆì§¸ ë£¨í”„ì—ì„œ ì›ì†Œë¥¼ ì…ë ¥ë°›ì€ ë’¤ ë‘ ë²ˆì§¸ ë£¨í”„ì—ì„œ ëˆ„ì í•©ì„ ê³„ì‚°í•œë‹¤. ë£¨í”„ ì•ˆì˜ ê³„ì‚°ì‹ì€ ì•ì„œ ì‚´í´ë³´ì•˜ë˜ ëˆ„ì í•© ê³„ì‚°ì‹ì´ë‹¤.

```java
for (int i = 1; i <= N; i++) {
    st = new StringTokenizer(br.readLine());
    for (int j = 1; j <= N; j++) {
        table[i][j] = Integer.parseInt(st.nextToken());
    }
}

for (int i = 1; i <= N; i++) {
    for (int j = 1; j <= N; j++) {
        pSum[i][j] = table[i][j] + pSum[i-1][j] + pSum[i][j-1] - pSum[i-1][j-1];
    }
}
```

ë§ˆì§€ë§‰ìœ¼ë¡œ Më²ˆ ë°˜ë³µí•˜ë©´ì„œ êµ¬ê°„ì„ ì…ë ¥ë°›ì•„ êµ¬ê°„í•© ê³„ì‚°ì‹ì„ ì ìš©í•œ ë’¤ ì¶œë ¥í•œë‹¤.
```java
    while (M-- > 0) {
        st = new StringTokenizer(br.readLine());
        int x1, y1, x2, y2;
        x1 = Integer.parseInt(st.nextToken());
        y1 = Integer.parseInt(st.nextToken());
        x2 = Integer.parseInt(st.nextToken());
        y2 = Integer.parseInt(st.nextToken());

        int result = pSum[x2][y2] - pSum[x1-1][y2] - pSum[x2][y1-1] + pSum[x1-1][y1-1];
        bw.write(result + "\n");
    }

    bw.flush();
    bw.close();
}
```

## ì „ì²´ ì½”ë“œ
```java
import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    static BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
    static int N, M;
    static int[][] table;
    static int[][] pSum;

    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        N = Integer.parseInt(st.nextToken());
        M = Integer.parseInt(st.nextToken());

        table = new int[N+5][N+5];
        pSum = new int[N+5][N+5];


        for (int i = 1; i <= N; i++) {
            st = new StringTokenizer(br.readLine());
            for (int j = 1; j <= N; j++) {
                table[i][j] = Integer.parseInt(st.nextToken());
            }
        }

        for (int i = 1; i <= N; i++) {
            for (int j = 1; j <= N; j++) {
                pSum[i][j] = table[i][j] + pSum[i-1][j] + pSum[i][j-1] - pSum[i-1][j-1];
            }
        }
        while (M-- > 0) {
            st = new StringTokenizer(br.readLine());
            int x1, y1, x2, y2;
            x1 = Integer.parseInt(st.nextToken());
            y1 = Integer.parseInt(st.nextToken());
            x2 = Integer.parseInt(st.nextToken());
            y2 = Integer.parseInt(st.nextToken());

            int result = pSum[x2][y2] - pSum[x1-1][y2] - pSum[x2][y1-1] + pSum[x1-1][y1-1];
            bw.write(result + "\n");
        }

        bw.flush();
        bw.close();
    }

}
```

## ì‹œê°„ë³µì¡ë„

ëˆ„ì í•©ì„ ê³„ì‚°í•  ë•Œ $O(N^2)$ì´ ê±¸ë¦¬ê³ , êµ¬ê°„í•© ê³„ì‚°ì€ Më²ˆ ë§Œí¼ ì‹œí–‰í•˜ë¯€ë¡œ $O(M)$ì´ ê±¸ë¦°ë‹¤. ì´ ë‘˜ì„ í•©ì¹˜ë©´ ìµœì¢… ì‹œê°„ë³µì¡ë„ëŠ” $O(N^2+M)$ì´ ëœë‹¤.
