# 1504 - íŠ¹ì •í•œ ìµœë‹¨ ê²½ë¡œ

ì´ ë¬¸ì œëŠ” 1ë¶€í„° Nê¹Œì§€ ì´ë™í•  ë•Œ u, vë¥¼ ë°˜ë“œì‹œ ê±°ì¹˜ëŠ” ìµœë‹¨ê²½ë¡œì˜ ê±°ë¦¬ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œë¡œ ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ ì‚¬ìš©í•˜ë©´ í’€ ìˆ˜ ìˆë‹¤.

ì´ ë¬¸ì œì—ì„œ ëˆˆì—¬ê²¨ë´ì•¼ í•  ê³³ì´ ìˆëŠ”ë°, ë‹¤ìŒê³¼ ê°™ë‹¤.

> ì„¸ì¤€ì´ëŠ” í•œë²ˆ ì´ë™í–ˆë˜ ì •ì ì€ ë¬¼ë¡ , í•œë²ˆ ì´ë™í–ˆë˜ ê°„ì„ ë„ ë‹¤ì‹œ ì´ë™í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë°˜ë“œì‹œ ìµœë‹¨ ê²½ë¡œë¡œ ì´ë™í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì— ì£¼ì˜í•˜ë¼. 

ì¦‰ ìš°ë¦¬ê°€ ê²½ë¡œë¥¼ ì°¾ì„ ë•Œ ê°„ì„ ì´ë‚˜ ì •ì ì´ ì¤‘ë³µë˜ëŠ”ì§€ëŠ” ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ë‹¤. ë‹¨ì§€ ê·¸ ê²½ë¡œì˜ ê±°ë¦¬ê°€ ìµœì†Œì¸ì§€ë§Œ í™•ì¸í•˜ë©´ ëœë‹¤. 

ì´ì œ $dist(a, b)$ê°€ ì •ì  aì—ì„œ bê¹Œì§€ ìµœë‹¨ê±°ë¦¬ë¥¼ ì£¼ëŠ” í•¨ìˆ˜ë¼ê³  í•  ë•Œ $dist(1, N)$ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬í•  ìˆ˜ ìˆë‹¤.

$$

dist(1, N) = \min \begin{cases} dist(1, u) + dist(u, v) + dist(v, N) \\ dist(1, v) + dist(v, u) + dist(u, N) \end{cases}

$$

ì™œ ê° ì •ì ì—ì„œ ì •ì ê¹Œì§€ì˜ ìµœì†Œ ê±°ë¦¬ë¥¼ ë”í•œ ê²ƒì´ ì „ì²´ì˜ ìµœì†Œ ê±°ë¦¬ê°€ ë ê¹Œ? ê·€ë¥˜ë²•ìœ¼ë¡œ í™•ì¸í•´ë³´ì. ì–´ë–¤ ì •ì ìœ¼ë¡œë¶€í„° ì •ì ê¹Œì§€ì˜ ìµœì†Œ ì´ë™ ê²½ë¡œì—ì„œ ì–´ë–¤ ë¶€ë¶„ ê²½ë¡œê°€ ìµœì†Œê°€ ì•„ë‹ ìˆ˜ ìˆë‹¤ê³  í•˜ì. ê·¸ë ‡ë‹¤ë©´ ê·¸ ë¶€ë¶„ê²½ë¡œê°€ ìµœì†Œê°€ ì•„ë‹ˆë¯€ë¡œ ìµœì†Œ ê²½ë¡œë¡œ ê°ˆì•„ë¼ìš°ë©´ ê¸°ì¡´ ìµœì†Œ ê²½ë¡œë³´ë‹¤ ë” ì‘ì€ ì „ì²´ ìµœì†Œ ê²½ë¡œê°€ ìƒê¸°ëŠ”ë°, ì´ëŠ” ëª¨ìˆœì´ë‹¤. ë”°ë¼ì„œ ì „ì²´ ê²½ë¡œê°€ ìµœì†Œ ë¹„ìš©ì´ë©´ ë¶€ë¶„ ê²½ë¡œë„ ìµœì†Œ ë¹„ìš©ì´ë‹¤.


[ğŸ”— ë¬¸ì œ ë§í¬](https://www.acmicpc.net/problem/1504)

## ì½”ë“œ

ê°„ì„ ì´ë‚˜ íƒìƒ‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ìœ í‹¸ í´ë˜ìŠ¤ë¡œ `Pair`ì„ ì„ ì–¸í•œë‹¤.

```java
static class Pair<T1, T2> {
    public T1 x;
    public T2 y;

    public Pair(T1 x, T2 y) {
        this.x = x;
        this.y = y;
    }
}
```

ì •ì ì˜ ê°œìˆ˜ `N`ê³¼ ê°„ì„ ì˜ ê°œìˆ˜ `E`ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ë‹¤ìŒìœ¼ë¡œ ê·¸ë˜í”„ë¥¼ í‘œí˜„í•  ë³€ìˆ˜ `graph`ë¥¼ ì„ ì–¸í•˜ê³  ArrayListë¡œ ì´ˆê¸°í™”í•œë‹¤.

```java
public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    int N, E;
    N = Integer.parseInt(st.nextToken());
    E = Integer.parseInt(st.nextToken());

    @SuppressWarnings("unchecked")
    List<Pair<Integer, Integer>>[] graph = new List[N+1];

    for (int i = 0; i <= N; i++) 
        graph[i] = new ArrayList<>();
```

ê·¸ë˜í”„ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ë¬¸ì œì—ì„œ ëŒ€ì¹­ì´ë¼ê³  í•˜ì˜€ìœ¼ë¯€ë¡œ from, to ì–‘ìª½ì— ëª¨ë‘ ê°„ì„ ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ ë°˜ë“œì‹œ ê±°ì³ì•¼ í•˜ëŠ” ì •ì  `u`, `v`ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤.

```java
    for (int i = 0; i < E; i++) {
        st = new StringTokenizer(br.readLine());
        int from, to, weight;

        from = Integer.parseInt(st.nextToken());
        to = Integer.parseInt(st.nextToken());
        weight = Integer.parseInt(st.nextToken());

        graph[from].add(new Pair<Integer, Integer>(to, weight));
        graph[to].add(new Pair<Integer, Integer>(from, weight));
    }

    st = new StringTokenizer(br.readLine());
    int u, v;
    u = Integer.parseInt(st.nextToken());
    v = Integer.parseInt(st.nextToken());
```

ì´ì œ í•„ìš”í•œ ë‹¤ìµìŠ¤íŠ¸ë¼ ì—°ì‚°ì„ í•œë‹¤. `dist1`ì—ëŠ” ì •ì  1ì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤. `distUV`ì—ëŠ” ì •ì  uì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤.  `distN`ì—ëŠ” ì •ì  Nì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ ê±°ë¦¬ê°€ ê³„ì‚°ë˜ì–´ ìˆë‹¤.

ì´ ì„¸ ê°€ì§€ë¥¼ ëª¨ë‘ êµ¬í–ˆë‹¤ë©´ ë‹µì„ ê³„ì‚°í•œë‹¤. ì´ ë¬¸ì œì—ì„œ ê·¸ë˜í”„ëŠ” ë¬´í–¥ì´ë¯€ë¡œ $dist(u, v) = dist(v, u)$, $dist(v, N) = dist(N, v)$, $dist(u, N) = dist(N, u)$ ë¥¼ ì´ìš©í•´ ì•„ë˜ ì½”ë“œì™€ ê°™ì´ ì‹ì„ ì„¸ìš¸ ìˆ˜ ìˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ ë‹µì„ ì¶œë ¥í•œë‹¤. ë§Œì•½ `result`ê°€ `INF`ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ë‹¤ë©´ 1, Nê¹Œì§€ ê°ˆ ìˆ˜ ìˆëŠ” ê²½ë¡œê°€ ì—†ë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ -1ì„ ì¶œë ¥í•˜ê³  ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ `result`ë¥¼ ì¶œë ¥í•œë‹¤.

```java
    long dist1[] = new long[N+1];
    dijkstra(1, dist1, graph);

    long distUV[] = new long[N+1];
    dijkstra(u, distUV, graph);

    long distN[] = new long[N+1];
    dijkstra(N, distN, graph);

    long result = Math.min(
        dist1[u] + distUV[v] + distN[v],
        dist1[v] + distUV[v] + distN[u]
    );

    System.out.println((result >= INF ? -1 : result));
}
```

ë‹¤ìµìŠ¤íŠ¸ë¼ í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤. ì¼ë°˜ì ì¸ êµ¬í˜„ ë°©ë²•ëŒ€ë¡œ êµ¬í˜„í–ˆìœ¼ë©° distë¥¼ ì™¸ë¶€ì—ì„œ ì°¸ì¡°í˜•ì‹ìœ¼ë¡œ ë°›ì•„ ê²°ê³¼ë¥¼ ë„£ì–´ì¤€ë‹¤.

```java
public static void dijkstra(int st, long[] dist, final List<Pair<Integer, Integer>>[] graph) {
    Arrays.fill(dist, INF);
    PriorityQueue<Pair<Integer, Long>> pq = new PriorityQueue<>(Comparator.comparingLong(e->e.y));

    pq.offer(new Pair<Integer, Long>(st, 0L));
    dist[st] = 0;

    while (!pq.isEmpty()) {
        Pair<Integer, Long> s = pq.poll();

        if (s.y > dist[s.x]) continue;

        for (Pair<Integer, Integer> adj : graph[s.x]) {
            if (s.y + adj.y < dist[adj.x]) {
                dist[adj.x] = s.y + adj.y;
                pq.offer(new Pair<Integer, Long>(adj.x, dist[adj.x]));
            }
        }
    }

}
```

## ì „ì²´ ì½”ë“œ

```java
import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    static class Pair<T1, T2> {
        public T1 x;
        public T2 y;

        public Pair(T1 x, T2 y) {
            this.x = x;
            this.y = y;
        }
    }

    static final long INF = Long.MAX_VALUE / 4;
    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        int N, E;
        N = Integer.parseInt(st.nextToken());
        E = Integer.parseInt(st.nextToken());

        @SuppressWarnings("unchecked")
        List<Pair<Integer, Integer>>[] graph = new List[N+1];

        for (int i = 0; i <= N; i++) 
            graph[i] = new ArrayList<>();

        for (int i = 0; i < E; i++) {
            st = new StringTokenizer(br.readLine());
            int from, to, weight;

            from = Integer.parseInt(st.nextToken());
            to = Integer.parseInt(st.nextToken());
            weight = Integer.parseInt(st.nextToken());

            graph[from].add(new Pair<Integer, Integer>(to, weight));
            graph[to].add(new Pair<Integer, Integer>(from, weight));
        }

        st = new StringTokenizer(br.readLine());
        int u, v;
        u = Integer.parseInt(st.nextToken());
        v = Integer.parseInt(st.nextToken());

        long dist1[] = new long[N+1];
        dijkstra(1, dist1, graph);

        long distUV[] = new long[N+1];
        dijkstra(u, distUV, graph);

        long distN[] = new long[N+1];
        dijkstra(N, distN, graph);

        long result = Math.min(
            dist1[u] + distUV[v] + distN[v],
            dist1[v] + distUV[v] + distN[u]
        );

        System.out.println((result >= INF ? -1 : result));
    }

    public static void dijkstra(int st, long[] dist, final List<Pair<Integer, Integer>>[] graph) {
        Arrays.fill(dist, INF);
        PriorityQueue<Pair<Integer, Long>> pq = new PriorityQueue<>(Comparator.comparingLong(e->e.y));

        pq.offer(new Pair<Integer, Long>(st, 0L));
        dist[st] = 0;

        while (!pq.isEmpty()) {
            Pair<Integer, Long> s = pq.poll();

            if (s.y > dist[s.x]) continue;

            for (Pair<Integer, Integer> adj : graph[s.x]) {
                if (s.y + adj.y < dist[adj.x]) {
                    dist[adj.x] = s.y + adj.y;
                    pq.offer(new Pair<Integer, Long>(adj.x, dist[adj.x]));
                }
            }
        }

    }
} 
```

## ì‹œê°„ë³µì¡ë„

ë‹¤ìµìŠ¤íŠ¸ë¼ì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O((V+E)\log V)$ ë¡œ ì•Œë ¤ì ¸ ìˆìœ¼ë©° ì´ ë¬¸ì œì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O(3 (N + E) \log N) \approx O((N+E) \log N)$ ì´ë‹¤. ìµœì•…ì˜ ê²½ìš°ì—ë„ $200800 \times \log 800 \approx 2008000$ ì´ë¯€ë¡œ ì»´í“¨í„°ê°€ 1ì´ˆì— ì—°ì‚°í•  ìˆ˜ ìˆëŠ” ì—°ì‚°íšŸìˆ˜ 1ì–µë³´ë‹¤ í›¨ì”¬ ì‘ë‹¤. ë”°ë¼ì„œ ì‹œê°„ì´ˆê³¼ ì—†ì´ í†µê³¼ ê°€ëŠ¥í•˜ë‹¤.