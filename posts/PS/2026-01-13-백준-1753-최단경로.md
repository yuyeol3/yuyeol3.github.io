# 1753 - ìµœë‹¨ê²½ë¡œ

ì „í˜•ì ì¸ ë‹¤ìµìŠ¤íŠ¸ë¼ ë¬¸ì œë¡œ ì •ì , ê°„ì„ ì˜ ìˆ˜ì™€ ì‹œì‘ ì •ì  ê·¸ë¦¬ê³  ê°„ì„ ì´ ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ë©°, ì´ë¥¼ ì…ë ¥ë°›ì•„ ì‹œì‘ ì •ì ì—ì„œ ê° ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ ê±°ë¦¬ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œì´ë‹¤.

ì´ ë¬¸ì œë¥¼ í’€ê¸° ìœ„í•´ ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ êµ¬í˜„í•˜ë©´ ë˜ë©° ì´ ë•Œ í•œ ë…¸ë“œì—ì„œ ë‹¤ë¥¸ ë…¸ë“œë¡œ ê°€ëŠ” ê°„ì„ ì´ ì—¬ëŸ¬ê°œì¼ ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì— ì£¼ì˜í•´ì•¼ í•œë‹¤(ê°€ì¤‘ì¹˜ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆê¸° ë•Œë¬¸).

[ğŸ”— ë¬¸ì œ ë§í¬](https://www.acmicpc.net/problem/1753)

## ì½”ë“œ

ê°„ì„ ê³¼ ë‹¤ìµìŠ¤íŠ¸ë¼ íƒìƒ‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•œ í´ë˜ìŠ¤ë¥¼ ì„ ì–¸í•œë‹¤.

```java
static class Edge {
    public int to;
    public int weight;

    public Edge(int to, int weight) {
        this.to = to;
        this.weight = weight;
    }
}

static class State {
    public int node;
    public long dist;

    public State(int node, long dist) {
        this.node = node;
        this.dist = dist;
    }
}
```

ì •ì  ìˆ˜ `V`, ê°„ì„  ìˆ˜ `E`, ì‹œì‘ ì •ì  `K`ë¥¼ ì…ë ¥ë°›ëŠ”ë‹¤. ê° ì •ì ë³„ ìµœë‹¨ ì´ë™ê±°ë¦¬ë¥¼ ì €ì¥í•  `dist` ë°°ì—´ì„ ì„ ì–¸í•˜ê³  ì´ˆê¸°ê°’ì„ ëª¨ë‘ `INF`ë¡œ ì„¤ì •í•´ë‘”ë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê° ì •ì ë³„ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ê°„ì„ ì„ ë‹´ì•„ë‘˜ `graph` ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤.

ì°¸ê³ ë¡œ `INF`ëŠ” ê°€ëŠ¥í•œ ì •ì ê¹Œì§€ì˜ ìµœë‹¨ê±°ë¦¬ì˜ ì§‘í•©ì—ì„œì˜ ìµœëŒ€ê°’ë³´ë‹¤ ë” í° ìˆ˜ì—¬ì•¼ í•œë‹¤. ì´ ë¬¸ì œì—ì„œ ê°„ì„  ìˆ˜ëŠ” ìµœëŒ€ 30ë§Œì´ê³ , ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ëŠ” ìµœëŒ€ 10ì´ë¯€ë¡œ ì–´ë– í•œ ìµœë‹¨ ê²½ë¡œë„ 3000005($E * 10 + 5$)ë³´ë‹¤ ê±°ë¦¬ê°€ í´ ìˆ˜ëŠ” ì—†ë‹¤. ì™œëƒí•˜ë©´ ìµœë‹¨ ê²½ë¡œëŠ” ë‹¨ìˆœ ê²½ë¡œì´ë¯€ë¡œ ê°™ì€ ê°„ì„ ì„ ë°˜ë³µí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ `INF = 3000005`ë¡œ ì„¤ì •í•´ ë‘ì—ˆë‹¤. 

```java
public static void main(String[] args) throws IOException {
    StringTokenizer st = new StringTokenizer(br.readLine());
    int V = Integer.parseInt(st.nextToken());
    int E = Integer.parseInt(st.nextToken());
    int K = Integer.parseInt(br.readLine());

    long[] dist = new long[V+5];
    Arrays.fill(dist, INF);
    
    @SuppressWarnings("unchecked")
    List<Edge>[] graph = new List[V+5];
    for (int i = 0; i < V+5; i++)
        graph[i] = new ArrayList<>();

```

ê°„ì„  ì •ë³´ë¥¼ ì…ë ¥ë°›ì•„ ê·¸ë˜í”„ì— ì¶”ê°€í•œë‹¤. ì´ ë•Œ ë°˜ë“œì‹œ ë‘ ì •ì ì— ëŒ€í•´ ì—¬ëŸ¬ ê°„ì„ ì´ ì¡´ì¬í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ì•¼ í•œë‹¤. ë˜í•œ ë°©í–¥ ê·¸ë˜í”„ì´ë¯€ë¡œ ëŒ€ì¹­ì ìœ¼ë¡œ ê°„ì„ ì„ ì‚½ì…í•˜ë©´ ì•ˆ ëœë‹¤.

ê·¸ëŸ° ë‹¤ìŒ dist ì†ì„± ê¸°ì¤€ ìµœì†Œ í™ êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” ìš°ì„ ìˆœìœ„ í `pq`ë¥¼ ìƒì„±í•˜ê³  íƒìƒ‰ì„ ì‹œì‘í•˜ëŠ” ìµœì´ˆ ì •ì ì¸ Kë¥¼ ë„£ëŠ”ë‹¤. ì •ì  `K->K` ê±°ë¦¬ëŠ” ë‹¹ì—°íˆ 0ì´ë¯€ë¡œ `dist[k] = 0`ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
```java
    for (int i = 1; i <= E; i++) {
        st = new StringTokenizer(br.readLine());

        int from = Integer.parseInt(st.nextToken());
        int to = Integer.parseInt(st.nextToken());
        int weight = Integer.parseInt(st.nextToken());

        graph[from].add(new Edge(to, weight));
    }

    PriorityQueue<State> pq 
        = new PriorityQueue<>(Comparator.comparingLong(e->e.dist));

    pq.offer(new State(K, 0));
    dist[K] = 0;
```

ë°˜ë³µë¬¸ì„ ëŒë©´ì„œ ê° ì •ì ë³„ ìµœì†Œ ê±°ë¦¬ë¥¼ êµ¬í•œë‹¤. ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ Stateë¥¼ êº¼ë‚´ê³ , ê·¸ Stateê°€ ìœ íš¨í•œì§€ í™•ì¸í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê·¸ Stateì—ì„œì˜ ì •ì ì„ ê¸°ì¤€ìœ¼ë¡œ ì¸ì ‘ ì •ì ì„ íƒìƒ‰í•˜ë©°, ë” ì§§ì€ ê±°ë¦¬ë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ ê±°ë¦¬ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ìš°ì„ ìˆœìœ„ íì— ë„£ëŠ”ë‹¤.

```java
    while (!pq.isEmpty()) {
        State s = pq.poll();
        if (s.dist > dist[s.node]) continue;

        for (Edge adj : graph[s.node]) {
            if (s.dist + adj.weight < dist[adj.to]) {
                dist[adj.to] = s.dist + adj.weight;
                pq.offer(new State(adj.to, dist[adj.to]));
            }
        }
    }
```

ë‹¤ìµìŠ¤íŠ¸ë¼ê°€ ëë‚˜ë©´ ëª¨ë“  ì •ì ë³„ ìµœë‹¨ ê±°ë¦¬ë¥¼ ì¶œë ¥í•œë‹¤. ì •ì ì˜ ê±°ë¦¬ê°€ `INF` ê°’ê³¼ ê°™ë‹¤ë©´ ì‹œì‘ ì •ì  Kì—ì„œ ë„ë‹¬í•  ìˆ˜ ì—†ëŠ” ì •ì ì„ì„ ì˜ë¯¸í•˜ë¯€ë¡œ INFë¥¼ ë¬¸ìì—´ë¡œ ì¶œë ¥í•œë‹¤. 

```java
    for (int i = 1; i <= V; i++) {
        bw.write((dist[i] == INF ? "INF" : dist[i]) + "\n");
    }
    bw.flush();

}
```

## ì „ì²´ ì½”ë“œ

```java
import java.util.*;
import java.io.*;

class Main {
    static BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    static BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
    static final long INF = 3000005L;

    static class Edge {
        public int to;
        public int weight;

        public Edge(int to, int weight) {
            this.to = to;
            this.weight = weight;
        }
    }

    static class State {
        public int node;
        public long dist;

        public State(int node, long dist) {
            this.node = node;
            this.dist = dist;
        }
    }

    public static void main(String[] args) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        int V = Integer.parseInt(st.nextToken());
        int E = Integer.parseInt(st.nextToken());
        int K = Integer.parseInt(br.readLine());

        long[] dist = new long[V+5];
        Arrays.fill(dist, INF);
        
        @SuppressWarnings("unchecked")
        List<Edge>[] graph = new List[V+5];
        for (int i = 0; i < V+5; i++)
            graph[i] = new ArrayList<>();


        for (int i = 1; i <= E; i++) {
            st = new StringTokenizer(br.readLine());

            int from = Integer.parseInt(st.nextToken());
            int to = Integer.parseInt(st.nextToken());
            int weight = Integer.parseInt(st.nextToken());

            graph[from].add(new Edge(to, weight));
        }

        PriorityQueue<State> pq 
            = new PriorityQueue<>(Comparator.comparingLong(e->e.dist));

        pq.offer(new State(K, 0));
        dist[K] = 0;

        while (!pq.isEmpty()) {
            State s = pq.poll();
            if (s.dist > dist[s.node]) continue;

            for (Edge adj : graph[s.node]) {
                if (s.dist + adj.weight < dist[adj.to]) {
                    dist[adj.to] = s.dist + adj.weight;
                    pq.offer(new State(adj.to, dist[adj.to]));
                }
            }
        }
        
        for (int i = 1; i <= V; i++) {
            bw.write((dist[i] == INF ? "INF" : dist[i]) + "\n");
        }
        bw.flush();

    }
}
```


## ì‹œê°„ë³µì¡ë„

ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O((V+E)\log V)$ ë¡œ ì•Œë ¤ì ¸ ìˆìœ¼ë¯€ë¡œ ì´ ì½”ë“œì˜ ì‹œê°„ë³µì¡ë„ëŠ” $O((V+E) \log V)$ ì´ë‹¤. ìµœì•…ì˜ ê²½ìš°ì—ë„ $(20000 + 300000) \cdot \log_2 20000 \approx 320000  \cdot 14.3 = 4576000 \lt 1\text{ì–µ} $ ì´ë¯€ë¡œ ì‹œê°„ì´ˆê³¼ ì—†ì´ í†µê³¼í•  ìˆ˜ ìˆë‹¤.